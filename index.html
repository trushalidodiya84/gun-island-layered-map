<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Gun Island – Layered Map</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
  #map { height: 90vh; }
</style>
</head>

<body>

<h3>Gun Island – Base Map</h3>
<div id="map"></div>

<script>

// Create map (ONLY ONCE)
var map = L.map('map').setView([25, 50], 4);

// Base map — NO labels
L.tileLayer(
  'https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png',
  { attribution: '© OpenStreetMap © CARTO' }
).addTo(map);

// marker pane on top
map.createPane('markerPaneTop');
map.getPane('markerPaneTop').style.zIndex = 650;

// Layers
var placeLayer = L.layerGroup().addTo(map);
var humanRouteLayer = L.featureGroup().addTo(map);
var animalRouteLayer = L.layerGroup().addTo(map);

// Sundarbans zone
L.polygon([
    [22.40, 88.10],
    [22.35, 89.10],
    [21.70, 89.60],
    [21.30, 89.20],
    [21.40, 88.20]
], {
    color: "green",
    fillColor: "green",
    fillOpacity: 0.25,
    weight: 2
}).addTo(placeLayer)
.bindPopup("<b>Sundarbans Ecological Zone</b><br>Repeated cyclones trigger migration.");

// Route style
var routeStyle = {
    color: "red",
    weight: 3,
    lineCap: "round",
    lineJoin: "round"
};

// Trafficking route steps
L.polyline([[21.80,89.00],[23.8103,90.4125]], routeStyle).addTo(humanRouteLayer)
.bindPopup("<b>Ecological Displacement</b>");

L.polyline([[23.8103,90.4125],[25.2048,55.2708]], routeStyle).addTo(humanRouteLayer)
.bindPopup("<b>Labour Migration Network</b>");

L.polyline([[25.2048,55.2708],[3.1390,101.6869]], routeStyle).addTo(humanRouteLayer)
.bindPopup("<b>Debt-Driven Mobility</b>");

L.polyline([[3.1390,101.6869],[-6.2088,106.8456]], routeStyle).addTo(humanRouteLayer)
.bindPopup("<b>Forced Secondary Migration</b>");

// subplot route
L.polyline([[40.6782,-73.9442],[22.5726,88.3639]], {
  color:"gray", weight:2, opacity:0.6, dashArray:"3,6"
}).addTo(humanRouteLayer);

// place marker
L.marker([21.9497,89.1833],{pane:'markerPaneTop'}).addTo(placeLayer)
.bindPopup("<b>Sundarbans</b>");
// Route stop markers (same layer as route)

// Sundarbans origin
L.marker([21.80,89.00],{pane:'markerPaneTop'}).addTo(humanRouteLayer)
.bindPopup("<b>Sundarbans</b><br>Climate-affected origin");

// Bangladesh transit
L.marker([23.8103,90.4125],{pane:'markerPaneTop'}).addTo(humanRouteLayer)
.bindPopup("<b>Bangladesh</b><br>Cross-border movement");

// Gulf labour destination
L.marker([25.2048,55.2708],{pane:'markerPaneTop'}).addTo(humanRouteLayer)
.bindPopup("<b>Gulf Region</b><br>Labour migration");

// Malaysia
L.marker([3.1390,101.6869],{pane:'markerPaneTop'}).addTo(humanRouteLayer)
.bindPopup("<b>Malaysia</b><br>Debt-driven movement");

// Indonesia
L.marker([-6.2088,106.8456],{pane:'markerPaneTop'}).addTo(humanRouteLayer)
.bindPopup("<b>Indonesia</b><br>Secondary smuggling destination");

// zoom to route
setTimeout(function(){
    map.fitBounds(humanRouteLayer.getBounds());
},500);

</script>


</body>
</html>
